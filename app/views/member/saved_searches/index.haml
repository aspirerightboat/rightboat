.member-content
  %h1 My Saved Searches
  %hr
  %p Here we record your saved searches. You can re-run them again, amend and set email alerts for each search. To set a new saved search, simply click 'Save Search and Set Alert' when browsing search results, or go to #{link_to 'Advanced Search', '#', class: 'toggle-adv-search'}.

  - if @saved_searches.none?
    .alert.alert-warning
      You havent saved searches yet
  - else
    %p Click on the Alert button to toggle new listings alerts on/off
    %table.rb-table
      %tr
        %th #
        %th keyword
        %th manufacturer
        %th model
        %th boat type
        %th country
        %th new / used
        %th year
        %th price
        %th length
        %th run
        %th delete
        %th alert
      - @saved_searches.each_with_index do |ss, i|
        %tr(data-ss-id="#{ss.id}")
          %td= i + 1
          %td= ss.q
          %td= ss.manufacturer
          %td
            - if ss.models.present?
              = Model.where(id: ss.models).pluck(:name).to_sentence
            - else
              = ss.model
          %td= ss.boat_type
          %td= Country.where(id: ss.country).pluck(:name).join(', ')
          %td= ss.new_used.keys.join(' / ')
          %td= "#{"from #{ss.year_min} " if ss.year_min}#{"upto #{ss.year_max}" if ss.year_max}"
          %td
            - if ss.price_min || ss.price_max
              - currency = (Currency.find_by(name: ss.currency) if ss.currency) || Currency.default
              = "from #{number_to_currency(ss.price_min, unit: currency.symbol, precision: 0)}" if ss.price_min
              = "upto #{number_to_currency(ss.price_max, unit: currency.symbol, precision: 0)}" if ss.price_max
          %td= "#{"from #{ss.length_min.to_i} " if ss.length_min.to_i}#{"upto #{ss.length_max}" if ss.length_max} #{ss.length_unit}" if ss.length_min || ss.length_max
          %td= link_to 'Run', search_path(ss.to_search_params), class: 'label label-primary'
          %td
            = link_to 'Delete', member_saved_search_path(ss), class: 'label label-danger', method: :delete,
                      remote: true, format: :js, data: {disable_with: 'Delete...'}
          %td
            = link_to (ss.alert ? 'Alert On' : 'No Alert'), toggle_member_saved_search_path(ss),
                      class: "toggle-alert label label-#{ss.alert ? 'success' : 'default'}", method: :post,
                      remote: true, format: :js, data: {disable_with: 'Alert...'}
