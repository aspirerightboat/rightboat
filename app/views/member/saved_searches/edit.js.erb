$(function() {
  $('#saved_search_edit_popup').remove();
  $(document.body).append('<%= j render('form_popup') %>');
  var $popup = $('#saved_search_edit_popup');

  $popup.displayPopup();
  $('.manufacturers-picker, .models-picker', $popup).makemodelPickers();
  $('.select-currency', $popup).currencySelect();
  $('.select-general', $popup).generalSelect();

  $('.saved-multiple-country-select').each(function() {
    var $sel = $(this);
    var selected_ids = $sel.data('selected-ids') || [];
    $.each($sel.children('option'), function(i, option) {
      var id = $(option).val();
      if ($.inArray(id, selected_ids) >= 0) {
        $(option).prop('selected', true);
      }
    });
    return $sel.select2();
  });

});
